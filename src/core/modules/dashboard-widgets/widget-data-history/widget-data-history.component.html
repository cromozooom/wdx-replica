<div class="w-100 flex-grow-1 d-flex flex-column">
  <div
    class="w-100 pt-2 px-2 d-flex align-items-center justify-content-between"
  >
    <div class="d-flex align-items-center gap-2">
      <select
        class="form-select w-auto d-inline-block"
        (change)="onDatasetChange($event)"
      >
        <option *ngFor="let ds of datasets" [selected]="ds === selectedDataset">
          {{ ds.label }}
        </option>
      </select>
      <span class="ms-2">{{ fakeData.length }} changes</span>
    </div>
    <div class="form-check form-switch">
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="syncDataSwitch"
        [(ngModel)]="syncData"
        (change)="renderTimeline()"
      />
      <label class="form-check-label" for="syncDataSwitch">Sync data</label>
    </div>
  </div>
  <div class="flex-grow-1 w-100 d-flex flex-column">
    <div class="w-100 p-2 d-flex align-items-center">
      <div class="border w-100 flex-grow-1 p-2">
        <div
          class="controlls d-flex justify-content-start align-items-center gap-2"
        >
          <div>
            <select
              class="form-select form-select-sm"
              aria-label="select timeframe"
              [(ngModel)]="timeframe"
              (change)="onTimeframeChange()"
            >
              <option value="daily">Day</option>
              <option value="week">Week</option>
              <option value="month">Month</option>
              <option value="year">Year</option>
              <option value="all">All the time</option>
            </select>
          </div>
          <div>
            <div class="btn-group" role="group" aria-label="Basic example">
              <button
                type="button"
                class="btn btn-sm btn-link text-decoration-none"
                (click)="timeframe === 'daily' ? goPrevDay() : onPrev()"
                [disabled]="
                  timeframe === 'daily'
                    ? !canGoPrevDay
                    : timeframe === 'week'
                      ? !canGoPrevWeek
                      : false
                "
              >
                Prev
              </button>
              <button
                type="button"
                class="btn btn-sm btn-link text-decoration-none"
                (click)="timeframe === 'daily' ? goNextDay() : onNext()"
                [disabled]="
                  timeframe === 'daily'
                    ? !canGoNextDay
                    : timeframe === 'week'
                      ? !canGoNextWeek
                      : false
                "
              >
                Next
              </button>
            </div>
          </div>
        </div>
        <!-- D3 Timeline Visualization -->
        <app-history-visualisation-data
          [data]="syncData ? filteredData : fakeData"
          [timeframe]="timeframe"
          [selectedDay]="selectedDay"
          [currentDate]="currentDate"
          [syncData]="syncData"
        ></app-history-visualisation-data>
      </div>
    </div>
    <div class="w-100 flex-grow-1 d-flex p-2">
      <app-grid-history-data
        class="w-100 flex-grow-1"
        [rowData]="fakeData"
        [columnDefs]="columnDefs"
        [defaultColDef]="{
          resizable: true,
          sortable: true,
          filter: true,
          autoHeight: true,
        }"
      ></app-grid-history-data>
    </div>
  </div>
</div>
