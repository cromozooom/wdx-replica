<div class="w-100 d-flex flex-column">
  <div class="mb-3">
    <label for="formSelect" class="form-label">Select Form</label>
    <select id="formSelect" class="form-select" [(ngModel)]="selectedFormId">
      <option *ngFor="let form of forms" [value]="form.id">
        {{ form.name }}
      </option>
    </select>
  </div>
  <div class="w-100" *ngIf="selectedFormId">
    <ag-grid-angular
      style="width: 100%; height: 100%"
      class="ag-theme-alpine"
      [rowData]="historyRows"
      [columnDefs]="columnDefs"
      [domLayout]="'autoHeight'"
      [animateRows]="true"
      [rowSelection]="{ mode: 'singleRow' }"
      (selectionChanged)="onSelectionChanged($event)"
    ></ag-grid-angular>
    <div class="mt-2 bg-light p-2 border">
      Selected row id: {{ selectedRows[0]?.entry?.id }}

      <button
        class="btn btn-outline-primary mb-2 me-2"
        (click)="openFullscreen(content)"
      >
        Fullscreen modal
      </button>
    </div>
  </div>
</div>

<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Modal title</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <button
            class="btn btn-sm btn-outline-secondary"
            (click)="modalGoPrev()"
            [disabled]="!modalPrev"
          >
            &#8592; Previous
          </button>
          <button
            class="btn btn-sm btn-outline-secondary"
            (click)="modalGoNext()"
            [disabled]="!modalNext"
          >
            Next &#8594;
          </button>
        </div>
        <div class="col-6">
          <div class="border border-info">
            <div
              class="btn-group mb-2 w-100 d-flex justify-content-between"
            ></div>
            <ng-container *ngIf="modalPrev; else showNextEntry">
              <b>Previous Entry:</b><br />
              <b>Date:</b> {{ modalPrev.date }}<br />
              <b>User:</b> {{ modalPrev.user }}<br />
              <b>Save Type:</b> {{ modalPrev.saveType }}<br />
              <pre>{{ modalPrev.entry?.data | json }}</pre>
            </ng-container>
            <ng-template #showNextEntry>
              <b>Next Entry:</b><br />
              <b>Date:</b> {{ modalNext.date }}<br />
              <b>User:</b> {{ modalNext.user }}<br />
              <b>Save Type:</b> {{ modalNext.saveType }}<br />
              <pre>{{ modalNext.entry?.data | json }}</pre>
            </ng-template>
          </div>
        </div>
        <div class="col-6">
          <div class="border border-success">
            <div *ngIf="modalCurrent; else noCurrent">
              <b>Current:</b><br />
              <b>Date:</b> {{ modalCurrent.date }}<br />
              <b>User:</b> {{ modalCurrent.user }}<br />
              <b>Save Type:</b> {{ modalCurrent.saveType }}<br />
              <pre>{{ modalCurrent.entry?.data | json }}</pre>
            </div>
            <ng-template #noCurrent>
              <span class="text-muted">No entry selected.</span>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
