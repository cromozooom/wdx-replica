<div class="configuration-editor">
  <div class="editor-header mb-4">
    <h3>{{ configuration ? 'Edit Configuration' : 'New Configuration' }}</h3>
  </div>

  <div class="editor-body">
    <!-- Metadata Form -->
    <div class="metadata-section mb-4">
      <h5>Configuration Details</h5>
      <app-configuration-metadata-form
        [configuration]="configuration"
        [showUpdateEntry]="!!configuration"
        (formChange)="onMetadataChange($event)"
        (updateEntryChange)="onUpdateEntryChange($event)"
      ></app-configuration-metadata-form>
    </div>

    <!-- Value Editor -->
    <div class="value-section">
      <h5>Configuration Value</h5>
      @if (editorFormat === 'json') {
        <app-json-editor
          [value]="value"
          (valueChange)="onValueChange($event)"
        ></app-json-editor>
      } @else if (editorFormat === 'xml') {
        <app-ace-editor
          [value]="value"
          [mode]="'xml'"
          (valueChange)="onValueChange($event)"
        ></app-ace-editor>
      } @else {
        <app-ace-editor
          [value]="value"
          [mode]="'text'"
          (valueChange)="onValueChange($event)"
        ></app-ace-editor>
      }
    </div>
  </div>

  <div class="editor-footer mt-4">
    <button
      class="btn btn-secondary me-2"
      (click)="onCancel()"
      [disabled]="saving"
    >
      Cancel
    </button>
    <button
      class="btn btn-primary"
      (click)="onSave()"
      [disabled]="saving"
    >
      @if (saving) {
        <span class="spinner-border spinner-border-sm me-2"></span>
      }
      {{ configuration ? 'Update' : 'Create' }}
    </button>
  </div>
</div>
